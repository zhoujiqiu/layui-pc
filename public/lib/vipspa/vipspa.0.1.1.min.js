!function(){function e(){}function t(e){var t=vipspa.routerMap[e.url];if(void 0===t){var n=vipspa.routerMap.defaults;return t=vipspa.routerMap[n],location.hash=n,!1}$.ajax({type:"GET",url:t.templateUrl,dataType:"html",success:function(e,n,o){$(vipspa.mainView).html(e),r(t.controller)},error:function(e,t,n){if(0===$(vipspa.errorTemplateId).length)return!1;var r=$(vipspa.errorTemplateId).html();r=r.replace(/{{errStatus}}/,e.status),r=r.replace(/{{errContent}}/,e.responseText),$(vipspa.mainView).html(r)}})}function n(){var e=location.hash;t(vipspa.parse(e))}function r(e,t){function n(){if(r.length<=o)return void("function"==typeof t&&t());var e=document.createElement("script");e.setAttribute("src",r[o]),e.onreadystatechange=e.onload=function(){e.onreadystatechange=null,document.documentElement.removeChild(e),e=null,o++,n()},document.documentElement.appendChild(e)}var r="string"==typeof e?e.split(","):e,o=0;n()}e.prototype.start=function(e){var t=this;t.routerMap=e.router,t.mainView=e.view,t.errorTemplateId=e.errorTemplateId,n(),window.onhashchange=function(){n()}};var o=[];e.prototype.getMessage=function(e){var t={};return $.each(o,function(n,r){r.id===e&&(t=r)}),t},e.prototype.setMessage=function(e){var t=JSON.parse(JSON.stringify(e));$.each(o,function(e,n){if(n.id===t.id)return n=t,!1}),o.push(t)},e.prototype.delMessage=function(e){if(void 0===e)return!1;var t=0;$.each(o,function(n,r){r.id===e&&(t=n)}),$.each(o,function(e,n){e>t&&(o[e-1]=n)})},e.prototype.clearMessage=function(e){o=[]},e.prototype.stringify=function(e,t){var n,r="";for(var o in t)r+=o+"="+encodeURIComponent(t[o])+"&";return""===r?n=e:(r=r.substring(0,r.length-1),n=e+"?"+r),n},e.prototype.parse=function(e){var t=void 0===e?location.hash:e,n={url:"",param:{}},r={},o="",a=t.indexOf("?");if(""===t)return n;if(a>-1){o=t.substring(1,a);var i=t.substring(a+1),p=i.split("&");$.each(p,function(e,t){var n,o,a=t.split("=");n=a[0],o=a[1],""!==n&&(r[n]=decodeURIComponent(o))})}else o=t.substring(1),r={};return{url:o,param:r}},window.vipspa=new e}();